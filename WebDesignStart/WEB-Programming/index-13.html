<html><head><META http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Internet Programming school</title><meta content="text/html; charset=windows-1251" http-equiv="Content-Type"><link href="lesson.css" tppabs="http://ips.ifmo.ru/css/lesson.css" type="text/css" rel="stylesheet"><link href="style.css" type="text/css" rel="stylesheet"><script type="text/javascript" src="../../../../js/upmenu.js" language="JavaScript"> </script><script type="text/javascript" src="../../../../js/popupmenu.js" language="JavaScript"> </script><script type="text/javascript" src="../../../../js/tree.js" language="JavaScript"> </script></head><body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" bgcolor="#ffffff"><table cellspacing="0" cellpadding="0" height="100%" width="100%"><tr><td><table width="100%"><tbody><tr><td height="59"><img src="logo.gif" tppabs="http://ips.ifmo.ru/img/logo.gif" width="310" height="45"></td><td align="right"><a href="javascript:if(confirm('http://ips.ifmo.ru/personal/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/personal/'" tppabs="http://ips.ifmo.ru/personal/" class="up">Вход</a><span> | </span><a href="javascript:if(confirm('http://ips.ifmo.ru/main/siteabout/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/main/siteabout/'" tppabs="http://ips.ifmo.ru/main/siteabout/" class="up">Карта сайта</a><span> | </span><a href="javascript:if(confirm('http://ips.ifmo.ru/about/contacts/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/about/contacts/'" tppabs="http://ips.ifmo.ru/about/contacts/" class="up">Контакты</a></td></tr></tbody></table></td></tr><tr><td><table border="0" width="100%" cellPadding="0" cellSpacing="0"><tbody><tr><td align="right" height="1" colspan="2"><img src="menu13.gif" tppabs="http://ips.ifmo.ru/img/menu13.gif"></td></tr><tr bgcolor="#000934"><td><img src="menu21.gif" tppabs="http://ips.ifmo.ru/img/menu21.gif" width="267" height="36"></td><td align="right"><img src="menu23.gif" tppabs="http://ips.ifmo.ru/img/menu23.gif" width="512" height="36"></td></tr><tr bgColor="#a45ad5"><td background="menu_back.gif" tppabs="http://ips.ifmo.ru/img/menu_back.gif" class="menu" height="24" colSpan="2">&nbsp;<a title="Главная" href="javascript:if(confirm('http://ips.ifmo.ru/main/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/main/'" tppabs="http://ips.ifmo.ru/main/">ГЛАВНАЯ</a>&nbsp;&nbsp;<a title="О проекте" href="javascript:if(confirm('http://ips.ifmo.ru/about/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/about/'" tppabs="http://ips.ifmo.ru/about/">О ПРОЕКТЕ</a>&nbsp;&nbsp;<a title="Академия программирования" href="javascript:if(confirm('http://ips.ifmo.ru/academy/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/academy/'" tppabs="http://ips.ifmo.ru/academy/">АКАДЕМИЯ ПРОГРАММИРОВАНИЯ</a>&nbsp;&nbsp;<a title="Учебные курсы" href="javascript:if(confirm('http://ips.ifmo.ru/courses/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/courses/'" tppabs="http://ips.ifmo.ru/courses/"><font color="yellow">УЧЕБНЫЕ КУРСЫ</font></a>&nbsp;&nbsp;<a title="Об олимпиадах" href="javascript:if(confirm('http://ips.ifmo.ru/olymp/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/olymp/'" tppabs="http://ips.ifmo.ru/olymp/">ОЛИМПИАДЫ</a>&nbsp;&nbsp;<a title="Персональная страница" href="javascript:if(confirm('http://ips.ifmo.ru/personal/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/personal/'" tppabs="http://ips.ifmo.ru/personal/">МОЙ IPS</a>&nbsp;&nbsp;</td></tr><tr bgcolor="#000934"><td></td><td align="right"><img src="menu33.gif" tppabs="http://ips.ifmo.ru/img/menu33.gif" width="512" height="5"></td></tr><tr bgcolor="#E2D3F5"><td></td><td align="right"><img src="menu43_.gif" tppabs="http://ips.ifmo.ru/img/menu43_.gif" width="512" height="6"></td></tr></tbody></table></td></tr><tr><td height="100%"><table height="100%" width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td width="194" class="lmenu" valign="top"><table class="lmenu" border="0" width="194"><tbody><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td width="10" valign="top"><img onclick="DisplayBranch('webprog/')" src="r_bull.gif" tppabs="http://ips.ifmo.ru/img/r_bull.gif" height="11"></td><td colspan="3" class="lmenuw"><a title="Клиентское Web-программирование" class="lmenu1" href="index.htm" tppabs="http://ips.ifmo.ru/courses/webprog/">Курс III</a></td></tr><tr><td colspan="4"><div show="true" id="webprog/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/ann/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title=" " class="lmenu2" href="index-1.htm" tppabs="http://ips.ifmo.ru/courses/webprog/ann/">Аннотация</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title="Язык сценариев JavaScript" class="lmenu2" href="index-2.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/">Часть I</a></td></tr><tr><td colspan="4"><div show="" id="webprog/part1/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Модель клиент-сервер в Интернете" class="lmenu3" href="index-3.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l1/">Урок 1</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Сценарии JavaScript в документах HTML" class="lmenu3" href="index-4.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l2/">Урок 2</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Переменные и литералы" class="lmenu3" href="index-5.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l3/">Урок 3</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l4/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Выражения и операции" class="lmenu3" href="index-6.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l4/">Урок 4</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l5/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Операторы" class="lmenu3" href="index-7.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l5/">Урок 5</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l6/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Функции" class="lmenu3" href="index-8.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l6/">Урок 6</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l7/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Встроенные объекты (1)" class="lmenu3" href="index-9.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l7/">Урок 7</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l8/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Встроенные объекты (2)" class="lmenu3" href="index-10.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l8/">Урок 8</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l9/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Создание собственных объектов" class="lmenu3" href="index-11.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l9/">Урок 9</a></td></tr></table></div></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title="Среда клиента" class="lmenu2" href="index-12.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/">Часть II</a></td></tr><tr><td colspan="4"><div show="" id="webprog/part2/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объектная модель MS Internet Explorer" class="lmenu3" href="index-13.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l1/">Урок 10</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объекты доступа к странице и ее элементам" class="lmenu3" href="index-14.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l2/">Урок 11</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Обработка событий в MS Internet Explorer" class="lmenu3" href="index-15.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l3/">Урок 12</a></td></tr></table></div></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2" class="lmenuw"><a title="Динамический HTML" class="lmenu2" href="index-16.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/">Часть III</a></td></tr><tr><td colspan="4"><div show="true" id="webprog/part3/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1" class="lmenuw">Урок 13</td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Примеры динамических страниц HTML" class="lmenu3" href="index-18.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l2/">Урок 14</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объектная модель документа DOM" class="lmenu3" href="index-19.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l3/">Урок 15</a></td></tr></table></div></td></tr></table></div></td></tr></tbody></table><br><br><br><table align="center"><tbody><tr><td><a href="javascript:if(confirm('http://www.ifmo.ru/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.ifmo.ru/'" tppabs="http://www.ifmo.ru/" title="Institute of fine mechanics and optics"><img border="0" src="ifmo.gif" tppabs="http://ips.ifmo.ru/img/ifmo.gif" height="29" width="64"></a></td></tr></tbody></table></td><td height="100%" valign="top"><table class="body"><tr><td><p class="link"><a href="index.htm" tppabs="http://ips.ifmo.ru/courses/webprog/" class="up">Клиентское Web-программирование</a>&nbsp;&raquo;&nbsp;<a href="index-16.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/" class="up">Часть III</a>&nbsp;&raquo;&nbsp;Урок 13</p><p class="header">Объектная модель документа DHTML</p><p> <em>Объектная модель документа</em> определяет логическую структуру документа и способ доступа и манипулирования составляющими документ элементами. Все, что определено в документе тегами языка разметки HTML-страниц, становится доступным для изменения, удаления и добавления. Программист может создавать документы, свободно перемещаться по их структуре и добавлять, изменять или удалять элементы и/или их содержимое. Эту технику принято называть динамическим HTML. </p><p> Динамический HTML в Internet Explorer 4.0 был реализован на базе объектной модели DHTML, разработанной фирмой Microsoft и послужившей основой для объектной модели DOM консорциума WWW. Начиная с версии 5.0 в браузере Internet Explorer полностью реализована эта объектная модель документа, но объектная модель документа DHTML продолжает существовать. </p><a name=""></a><h2> Структура документа </h2><p> В объектной модели DHTML любой документ представляется в виде логической древовидной структуры. Следующий фрагмент документа HTML: </p><dir><pre>
&lt;BODY&gt;
&lt;P ID='p1'&gt; В блоковый элемент, каким является абзац,
можно добавлять &lt;B ID='b1'&gt;встраиваемые элементы&lt;/B&gt;, каковым
является элемент IMG: &lt;IMG ID='img1' SRC="my.gif"&gt;
&lt;/P&gt;
&lt;IMG ID='img2' SRC="my-1.gif"&gt;
&lt;/BODY&gt;
   </pre></dir><p> будет представлен в объектной модели DHTML логической структурой, показанной на рисунке: </p><a name="ris1"><table align="center" class="figure" width="100%"><tr><td align="center"><img src="img1-2.gif" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l1/img1.gif"></td></tr><tr align="center"><td>Рис. 1.</td></tr></table></a><p> Для сложного документа логическая структура будет, естественно, сложнее. В ней может оказаться много "деревьев", которые в сумме будут представлять уже некоторый "лес". </p><p> <em>Объектная модель</em> DHTML предоставляет разработчикам Web-документов прямой программируемый доступ ко всем элементам документа, а совместно с событийной моделью подобный подход позволяет браузеру обрабатывать ввод пользователя, выполнять встроенные сценарии и динамически менять содержимое документа, не перезагружая его. </p><p> Каждый элемент документа HTML является в этой модели программируемым объектом. Это означает, что существует возможность динамически изменять содержимое элементов страницы, перемещать их по иерархии, добавлять новые элементы или удалять существующие, изменять форматирование (внешний вид) элементов страницы. Подобные действия реализуются через сценарии, выполняемые как реакция на определенные действия пользователя или системы. </p><a name=""></a><h2> Иерархия объектов </h2><p> Каждый объект в иерархии, предоставляемой объектной моделью документа HTML, можно использовать в сценарии JavaScript, но для этого необходимо получить доступ к соответствующему объекту. </p><p> В иерархической объектной модели одну из важных ролей при доступе к объектам играют два семейства, являющиеся свойствами любого объекта HTML, - <tt>all</tt> и <tt>children</tt>. В первом содержатся ссылки на <em>все объекты, расположенные ниже объекта в иерархии</em>, тогда как второй содержит ссылки на <em>все объекты, непосредственно порождаемые данным</em>. Например, семейство <tt>all</tt> объекта <tt>body</tt> приведенного выше документа HTML содержит ссылки на все объекты документа, в том числе и на <tt>p1</tt>, <tt>img1</tt>, <tt>b1</tt> и <tt>img2</tt>. Семейство <tt>children</tt> будет ссылаться только на два объекта, непосредственно порождаемых элементом <tt>body</tt> - <tt>p1</tt>, <tt>img2</tt>. </p><p> На вершине всей иерархии объектов расположен объект <tt>document</tt>, который "порождает" все объекты, представляющие элементы HTML. Этот объект также имеет свойство-семейство <tt>all</tt> (семейства  <tt>children</tt> у него нет), содержащий ссылки на <em>все</em> объекты документа. </p><p> Отметим одну особенность семейства <tt>all</tt> объекта <tt>document</tt> - оно всегда содержит ссылки на объекты <tt>HTML</tt>, <tt>HEAD</tt>, <tt>TITLE</tt> и <tt>BODY</tt>, даже если соответствующие теги отсутствуют в документе (браузеры обычно позволяют их пропускать и сразу же задавать тело документа). </p><p> В семейство <tt>all</tt> объекта <tt>document</tt> не включается задаваемый без тегов разметки, хотя и отображаемый на странице, текст (браузер IE позволяет это делать). Таким образом, в объектной модели DHTML он будет просто потерян - к нему будет невозможен доступ. </p><p> Кроме объектов, представляющих распознаваемые и отображаемые браузером элементы HTML, в семейства <tt>all</tt> и <tt>children</tt> попадают также комментарии HTML и неизвестные или ошибочные теги (без своего содержимого, которое отображается как неразмеченный текст). </p><p> Для получения ссылки на интересующий объект, "хранящийся" в любом семействе, следует использовать целочисленный индекс (отсчет от нуля) или строковый индекс (имя) соответствующего элемента. Имя элемента HTML - значение его атрибута <tt>ID</tt> или атрибута <tt>NAME</tt>. Отметим, что имя элемента в то же время является свойством объекта-семейства, в которое он включен. </p><p> Например, чтобы обратиться к объекту, представляющему первый абзац приведенного в начале урока примера страницы HTML, можно использовать одну из следующих конструкций: </p><dir><pre>
document.all[4]
document.all['p1']
document.all.p1
  </pre></dir><p> В Internet Explorer можно просто ссылаться на элемент HTML, используя его имя, определяемое значением атрибута <tt>IDM</tt> или <tt>NAME</tt>, в качестве переменной, хранящей ссылку на объект, соответствующий указанному элементу HTML. Это справедливо для всех элементов страницы за исключением элементов управления формы - к ним доступ осуществляется только через родительский объект <tt>form</tt> (хотя с использованием семейства  <tt>document.all</tt> придерживаться такой иерархии совершенно не обязательно). Таким образом, на первый абзац можно сослаться и просто как <tt>p1</tt>. </p><p> При программировании достаточно полезным свойством семейств является свойство <tt>length</tt>, в котором хранится общее число объектов в наборе. Его обычно используют для организации перебора элементов в семействе с помощью цикла <tt>for</tt>. Однако в этом случае большую производительность и удобство дает цикл <tt>for...in</tt>. </p><a name="example23"></a><table class="example"><caption>Пример #1.  Два способа перебора элементов семейства </caption><tr><td colspan="2"><dir><pre>
&lt;TITLE&gt;Цикл по элементам семейства&lt;/TITLE&gt;
&lt;SCRIPT&gt;
  var s = "По первому способу\n"
  function listOfAllElements() {
// первый способ
    for (i=0; i&lt;document.all.length; i++) {
      s += "&lt;" + document.all[i].tagName + "&gt;\n";
    }
// второй способ
    s += "\nПо второму способу\n"
    for (i in document.all) {
      s += "&lt;" + document.all[i].tagName + "&gt;\n";
    }
    alert(s)
  }
&lt;/SCRIPT&gt;
&lt;BODY onload="listOfAllElements()"&gt;
&lt;H1&gt;Привет!&lt;/H1&gt;
&lt;P&gt;Это &lt;I&gt;учебная&lt;/I&gt; страница &lt;B&gt;HTML&lt;/B&gt;.&lt;/p&gt;
      </pre></dir><p> При загрузке документа вызывается функция <tt>listOfAllElements()</tt>, которая в двух циклах просматривает семейство <tt>all</tt> объекта <tt>document</tt> и отображает диалоговое окно со всеми элементами HTML страницы. </p><p> Отметим, что по второму способу первым "объектом" семейства будет ссылка на свойство <tt>length</tt> семейства. </p></td></tr></table><p> Иногда необходимо из всего множества объектов страницы выделить подмножество объектов, соответствующих некоторому типу элементов HTML. На странице обычно содержится несколько заголовков, например, первого уровня. В семействе <tt>all</tt> они расположены вперемежку с остальными объектами, но если необходимо выделить их из всего множества элементов, то подобную операцию можно осуществить, используя метод <tt>tags()</tt> семейства <tt>all</tt>: </p><a name="example24"></a><table class="example"><caption>Пример #2. </caption><tr><td colspan="2"><dir><pre>
var paragraphs = document.all.tags('P')
for (i=0; i &lt; paragraphs.length; i++)
     paragraphs[i].style.color = 'blue';
      </pre></dir></td></tr></table><p> Метод <tt>tags()</tt> возвращает семейство, хранящее ссылки на все элементы с указанным в качестве параметра именем тега. В дальнейшем работа со вновь созданным семейством осуществляется обычным способом. </p><a name=""></a><h2> Свойства и методы объектов </h2><p> Большинство свойств объектов соответствуют атрибутам представляемых ими элементов HTML документа и имеют такие же имена, что и имена атрибутов. В сценарии можно получить значения интересующих атрибутов элемента или, наоборот, изменить их установку. Динамическое изменение свойств объектов, и, соответственно, представляемых ими элементов HTML, является основной концепцией динамического HTML. </p><p> Имена некоторых свойств объектов отличаются от имен атрибутов, но обычно достаточно близки к именам представляемых атрибутов. Например, свойство <tt>className</tt> соответствует атрибуту <tt>CLASS</tt>. Подобное несоответствие связано, в основном, с именами атрибутов, которые могут конфликтовать с зарезервированными ключевыми словами основных языков сценариев. </p><p> Некоторые свойства не соответствуют никаким атрибутам тегов. Эти свойства предоставляют дополнительную информацию об элементе и обычно являются свойствами только для чтения. С одним из подобных свойств мы уже знакомы. Свойство <tt>tagName</tt> не соответствует никакому атрибуту и предоставляет информацию о типе тега элемента. Другим примером является свойство <tt>sourceIndex</tt>, значением которого является индекс элемента в семействе <tt>all</tt>. </p><p> Некоторые свойства объектов доступны только для чтения. Это означает, что можно получить их значение, но нельзя изменить. Примером подобного свойства является свойство <tt>tagName</tt>, представляющее имя тега HTML элемента. </p><p> В объектной модели существуют свойства, представляющие целое множество свойств объекта. Они реализованы в виде семейств и к ним применима описанная выше технология работы с любым семейством JavaScript. </p><p> Свойство <tt>style</tt> объекта одно из таких свойств. Оно хранит значения всех свойств каскадных таблицей стилей, установленных для соответствующего элемента. Ключом доступа является имя свойства. Например, обратиться к свойству <tt>color</tt> какого-либо элемента HTML из сценария JavaScript можно с использованием следующего синтаксиса: </p><dir><pre>
ссылка_на_объект.style.color
ссылка_на_объект.style['color']
  </pre></dir><p> В каскадных таблицах стилей свойства форматирования имеют названия, в которых используется дефис: <tt>background-color</tt>, <tt>margin-top</tt>, <tt>border-left</tt> и т.д. Имя такого свойства в сценарии определяется следующим образом: </p><ul type="1"><li><p>Убирается из названия свойства дефис (-).</p></li><li><p>Часть имени свойства после дефиса присоединяется к предшествующей части с прописной буквы.</p></li><li><p>Предыдущие два пункта повторяются для всех вхождений дефиса в название свойства.</p></li></ul><p> Например, свойство <tt>border-right-width</tt> в сценарии JavaScript будет выглядеть <tt>borderRightWidth</tt>, на свойство <tt>background-color</tt> можно ссылаться как <tt>backgroundColor</tt>. </p><p> Методы <tt>getAttribute()</tt>, <tt>setAttribute()</tt> и <tt>removeAttribute()</tt> любого элемента HTML позволяют, соответственно, получать, устанавливать значения его атрибутов или удалять их. Для методов <tt>getAttribute()</tt> и <tt>removeAttribute()</tt> параметром является строка, задающая имя атрибута, в метод <tt>setAttribute()</tt> кроме имени атрибута необходимо передать и его значение. </p><p> Эти три метода не чувствительны к регистру. Если для установки значения атрибута или для задания его имени важен регистр, то дополнительный, последний параметр, принимающий значения <tt>true</tt> или <tt>false</tt>, определяет чувствительность этих методов к регистру. </p><p> Выполнить прокрутку большого документа таким образом, чтобы какой-либо элемент HTML появился в окне браузера, можно методом <tt>scrollIntoView()</tt> этого элемента. Элемент может появиться вверху или внизу окна. Значение единственного параметра этого метода равное <tt>true</tt> (умалчиваемое значение) отображает элемент в верхней части области отображения, тогда как значение <tt>false</tt> соответствует отображению элемента в нижней части окна браузера. Например, в следующем фрагменте сценария осуществляется быстрый переход к третьему заголовку первого уровня документа: </p><dir><pre>
var myH1=document.all.tags('H1');
if( myH1.length &gt; 0 ) myH1[2].scrollIntoView(true);
 </pre></dir><p> Объектная модель позволяет осуществлять доступ к содержимому элементов и даже изменять не только содержимое, но и сами элементы заменять на другие. Эти действия осуществляются с помощью следующих свойств объектов: <tt>innerHTML</tt>, <tt>innerText</tt>, <tt>outerHTML</tt> и <tt>outerText</tt>.  </p><p> Свойства с префиксом <tt>inner</tt> отвечают за содержимое элемента HTML и позволяют в сценарии или получить его, или динамически заменить на новое, оставляя неизменными теги разметки самого элемента. Свойства с префиксом <tt>outer</tt> применяются ко всему элементу HTML (вместе с его открывающим и закрывающим тегами) и используются для замены элемента вместе с его содержимым на некоторый новый элемент. </p><p> Свойства с суффиксом <tt>Text</tt> работают с текстовым содержимым элемента HTML с удаленными тегами разметки, тогда как свойства с суффиксом HTML оперируют с размеченным тегами HTML содержимым. </p><p> На рисунке скобками отмечены "области влияния" рассмотренных четырех свойств элемента на его содержимое: </p><a name="ris2"><table align="center" class="figure" width="100%"><tr><td align="center"><img src="img2-1.gif" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l1/img2.gif"></td></tr><tr align="center"><td>Рис. 2.</td></tr></table></a><p> Для элемента <tt>P</tt>, представленного на рисунке, значением свойства <tt>innerText</tt> будет строка </p><dir><pre>
"Содержимое элемента"
  </pre></dir><p> Тогда как для свойства <tt>innerHTML</tt> строка </p><dir><pre>
"Содержимое &lt;i&gt;элемента&lt;/i&gt;"
  </pre></dir><p> Значение свойства <tt>outerText</tt> совпадает со значением свойства <tt>innerText</tt>, а свойство <tt>outerHTML</tt> хранит полное описание элемента </p><dir><pre>
"&lt;p&gt;Содержимое &lt;i&gt;элемента&lt;/i&gt;&lt;/p&gt;"
  </pre></dir><p> Изменение в сценарии значений указанных свойств приводит либо к изменению содержимого элемента, либо его полной замене на новый элемент (в случае использования свойства <tt>outerHTML</tt>). Заметим, что можно задавать значения свойств с суффиксом <tt>Text</tt> и в виде строки с тегами разметки HTML, но в этом случае теги браузером не интерпретируются, а отображаются как обычный текст. </p><p> <strong>Методы insertAdjacentText и insertAdjacentHTML</strong> </p><p> В объектной модели DHTML для каждого элемента предусмотрены два метода, позволяющие добавить перед открывающим тегом (после закрывающего тега) или в начало (конец) содержимого элемента простой текст или текст с разметкой HTML: </p><dir><pre>
insertAdjacentText(положение, текст)
insertAdjacentHTML(положение, текст)
  </pre></dir><p> Параметр текст является строковым литералом или строковой переменной. Для первого метода он содержит обычный простой текст, а для второго метода текст, размеченный тегами HTML, который интерпретируется браузером. </p><p> Параметр положение может принимать одно из следующих значений - <tt>"beforeBegin"</tt>, <tt>"afterBegin"</tt>, <tt>"beforeEnd"</tt>, <tt>"afterEnd"</tt>. Место вставки текста в соответствии с указанными значениями этого параметра показано на рисунке: </p><a name="ris3"><table align="center" class="figure" width="100%"><tr><td align="center"><img src="img3-1.gif" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l1/img3.gif"></td></tr><tr align="center"><td>Рис. 3.</td></tr></table></a><p> Для размеченного текста HTML выполняется синтаксический разбор, и он отображается в соответствии с заданным форматированием. При этом корректируется объектная модель документа для отражения внесенного в документ изменения. </p><a name="exercise1"></a><table class="exercise"><caption>Упражнение #1. </caption><tr class="exercise"><td><p> Разработать страницу для демонстрации возможностей свойств <tt>innerText, innerHTML, outerText, outerHTML</tt> и методов <tt>insertAdjacentText</tt>, <tt>insertAdjacentHTML</tt>. Страница может выглядеть следующим образом: </p><a name="ris4"><table align="center" class="figure" width="100%"><tr><td align="center"><img src="img4.gif" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l1/img4.gif"></td></tr><tr align="center"><td>Рис. 4.</td></tr></table></a><p> Страница состоит из абзаца и формы с полями, в которых отображаются значения указанных рядом с ними свойств абзаца. В этих же полях можно задать собственные значения свойств и нажатием расположенной слева соответствующей кнопки <strong>Изменить</strong> действительно изменить значения указанных свойств абзаца. </p><p> Для демонстрации работы методов в раскрывающемся списке <strong>Куда</strong> выбираются значения первого параметра, в поле Что задается второй параметр, а при нажатии на кнопку <strong>Вставить</strong> выполняется соответствующий метод абзаца. </p></td></tr></table><br><a name="exercise2"></a><table class="exercise"><caption>Упражнение #2. </caption><tr class="exercise"><td><p> Разработать страницу, текст которой представляет 3 главы книги (каждая глава занимает полторы области отображения браузера). В начале страницы поместить содержание, оформленное в виде гиперссылок. При щелчке на гиперссылке методом <tt>scrollIntoView()</tt> отобразить начало содержимого соответствующей главы. В конце каждой главы поставить ссылку, возвращающую пользователя на начало документа. Посмотреть действие параметра этого метода. </p></td></tr></table><br><a name="exercise3"></a><table class="exercise"><caption>Упражнение #3. </caption><tr class="exercise"><td><p> Разработать страницу, добавляющую при щелчке на любом элементе HTML к нему границу, определяемую с помощью свойств каскадных таблиц стилей. </p></td></tr></table><br><a name="exercise4"></a><table class="exercise"><caption>Упражнение #4. </caption><tr class="exercise"><td><p> Разработать страницу, тестирующую работу методов добавления, изменения и удаления атрибутов абзаца. </p></td></tr></table><br><a name="exercise5"></a><table class="exercise"><caption>Упражнение #5. </caption><tr class="exercise"><td><p> Разработать страницу, при загрузке которой в отдельном окне браузера отображается ее иерархическая структура DHTML со смещением названий тегов вложенных элементов вида: </p><dir><pre>
body
    p
        img
        b
        i
    p
    ul
        li
             b
        li
    p
    </pre></dir></td></tr></table><br><table cellspacing="0" align="center" width="90%" border="0"><tr><td align="left"><a href="index-10.html" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l3/index.html">&lt;&lt;&lt; Предыдущий урок</a></td><td align="right"><a href="index-15.html" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l2/index.html">Следующий урок &gt;&gt;&gt;</a></td></tr></table><br><br><br></td></tr></table><br></td><td background="dot.gif" tppabs="http://ips.ifmo.ru/img/dot.gif" width="1"><img width="1" src="spacer.gif" tppabs="http://ips.ifmo.ru/img/spacer.gif" height="157"></td></tr><tr><td class="lmenu" width="194" height="9"><font style="font-size:9px;font-family:arial;">Copyright &copy; 2003 IPS</font></td><td colspan="2" align="right"><img src="foot.gif" tppabs="http://ips.ifmo.ru/img/foot.gif"></td></tr></table></td></tr></table></body></html>