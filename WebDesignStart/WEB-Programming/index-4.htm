<html><head><META http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Internet Programming school</title><meta content="text/html; charset=windows-1251" http-equiv="Content-Type"><link href="lesson.css" tppabs="http://ips.ifmo.ru/css/lesson.css" type="text/css" rel="stylesheet"><link href="style.css" tppabs="http://ips.ifmo.ru/css/style.css" type="text/css" rel="stylesheet"><script type="text/javascript" src="../../../../js/upmenu.js" language="JavaScript"> </script><script type="text/javascript" src="../../../../js/popupmenu.js" language="JavaScript"> </script><script type="text/javascript" src="../../../../js/tree.js" language="JavaScript"> </script></head><body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" bgcolor="#ffffff"><table cellspacing="0" cellpadding="0" height="100%" width="100%"><tr><td><table width="100%"><tbody><tr><td height="59"><img src="logo.gif" tppabs="http://ips.ifmo.ru/img/logo.gif" width="310" height="45"></td><td align="right"><a href="javascript:if(confirm('http://ips.ifmo.ru/personal/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/personal/'" tppabs="http://ips.ifmo.ru/personal/" class="up">Вход</a><span> | </span><a href="javascript:if(confirm('http://ips.ifmo.ru/main/siteabout/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/main/siteabout/'" tppabs="http://ips.ifmo.ru/main/siteabout/" class="up">Карта сайта</a><span> | </span><a href="javascript:if(confirm('http://ips.ifmo.ru/about/contacts/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/about/contacts/'" tppabs="http://ips.ifmo.ru/about/contacts/" class="up">Контакты</a></td></tr></tbody></table></td></tr><tr><td><table border="0" width="100%" cellPadding="0" cellSpacing="0"><tbody><tr><td align="right" height="1" colspan="2"><img src="menu13.gif" tppabs="http://ips.ifmo.ru/img/menu13.gif"></td></tr><tr bgcolor="#000934"><td><img src="menu21.gif" tppabs="http://ips.ifmo.ru/img/menu21.gif" width="267" height="36"></td><td align="right"><img src="menu23.gif" tppabs="http://ips.ifmo.ru/img/menu23.gif" width="512" height="36"></td></tr><tr bgColor="#a45ad5"><td background="menu_back.gif" tppabs="http://ips.ifmo.ru/img/menu_back.gif" class="menu" height="24" colSpan="2">&nbsp;<a title="Главная" href="javascript:if(confirm('http://ips.ifmo.ru/main/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/main/'" tppabs="http://ips.ifmo.ru/main/">ГЛАВНАЯ</a>&nbsp;&nbsp;<a title="О проекте" href="javascript:if(confirm('http://ips.ifmo.ru/about/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/about/'" tppabs="http://ips.ifmo.ru/about/">О ПРОЕКТЕ</a>&nbsp;&nbsp;<a title="Академия программирования" href="javascript:if(confirm('http://ips.ifmo.ru/academy/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/academy/'" tppabs="http://ips.ifmo.ru/academy/">АКАДЕМИЯ ПРОГРАММИРОВАНИЯ</a>&nbsp;&nbsp;<a title="Учебные курсы" href="javascript:if(confirm('http://ips.ifmo.ru/courses/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/courses/'" tppabs="http://ips.ifmo.ru/courses/"><font color="yellow">УЧЕБНЫЕ КУРСЫ</font></a>&nbsp;&nbsp;<a title="Об олимпиадах" href="javascript:if(confirm('http://ips.ifmo.ru/olymp/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/olymp/'" tppabs="http://ips.ifmo.ru/olymp/">ОЛИМПИАДЫ</a>&nbsp;&nbsp;<a title="Персональная страница" href="javascript:if(confirm('http://ips.ifmo.ru/personal/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ips.ifmo.ru/personal/'" tppabs="http://ips.ifmo.ru/personal/">МОЙ IPS</a>&nbsp;&nbsp;</td></tr><tr bgcolor="#000934"><td></td><td align="right"><img src="menu33.gif" tppabs="http://ips.ifmo.ru/img/menu33.gif" width="512" height="5"></td></tr><tr bgcolor="#E2D3F5"><td></td><td align="right"><img src="menu43_.gif" tppabs="http://ips.ifmo.ru/img/menu43_.gif" width="512" height="6"></td></tr></tbody></table></td></tr><tr><td height="100%"><table height="100%" width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td width="194" class="lmenu" valign="top"><table class="lmenu" border="0" width="194"><tbody><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td width="10" valign="top"><img onclick="DisplayBranch('webprog/')" src="r_bull.gif" tppabs="http://ips.ifmo.ru/img/r_bull.gif" height="11"></td><td colspan="3" class="lmenuw"><a title="Клиентское Web-программирование" class="lmenu1" href="index.htm" tppabs="http://ips.ifmo.ru/courses/webprog/">Курс III</a></td></tr><tr><td colspan="4"><div show="true" id="webprog/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/ann/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title=" " class="lmenu2" href="index-1.htm" tppabs="http://ips.ifmo.ru/courses/webprog/ann/">Аннотация</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2" class="lmenuw"><a title="Язык сценариев JavaScript" class="lmenu2" href="index-2.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/">Часть I</a></td></tr><tr><td colspan="4"><div show="true" id="webprog/part1/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Модель клиент-сервер в Интернете" class="lmenu3" href="index-3.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l1/">Урок 1</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1" class="lmenuw">Урок 2</td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Переменные и литералы" class="lmenu3" href="index-5.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l3/">Урок 3</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l4/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Выражения и операции" class="lmenu3" href="index-6.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l4/">Урок 4</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l5/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Операторы" class="lmenu3" href="index-7.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l5/">Урок 5</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l6/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Функции" class="lmenu3" href="index-8.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l6/">Урок 6</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l7/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Встроенные объекты (1)" class="lmenu3" href="index-9.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l7/">Урок 7</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l8/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Встроенные объекты (2)" class="lmenu3" href="index-10.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l8/">Урок 8</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part1/l9/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Создание собственных объектов" class="lmenu3" href="index-11.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l9/">Урок 9</a></td></tr></table></div></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title="Среда клиента" class="lmenu2" href="index-12.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/">Часть II</a></td></tr><tr><td colspan="4"><div show="" id="webprog/part2/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объектная модель MS Internet Explorer" class="lmenu3" href="index-13.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l1/">Урок 10</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объекты доступа к странице и ее элементам" class="lmenu3" href="index-14.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l2/">Урок 11</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part2/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Обработка событий в MS Internet Explorer" class="lmenu3" href="index-15.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part2/l3/">Урок 12</a></td></tr></table></div></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="2"><a title="Динамический HTML" class="lmenu2" href="index-16.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/">Часть III</a></td></tr><tr><td colspan="4"><div show="" id="webprog/part3/"><table class="lmenu" width="100%"><tr><td width="10"></td><td width="10"></td><td width="10"></td><td width="100%"></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l1/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объектная модель документа DHTML" class="lmenu3" href="index-17.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l1/">Урок 13</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l2/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Примеры динамических страниц HTML" class="lmenu3" href="index-18.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l2/">Урок 14</a></td></tr><tr><td>&nbsp;&nbsp;&nbsp;</td><td>&nbsp;&nbsp;&nbsp;</td><td width="10" valign="top"><img onclick="DisplayBranch('webprog/part3/l3/')" src="w_bull.gif" tppabs="http://ips.ifmo.ru/img/w_bull.gif" height="11"></td><td colspan="1"><a title="Объектная модель документа DOM" class="lmenu3" href="index-19.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part3/l3/">Урок 15</a></td></tr></table></div></td></tr></table></div></td></tr></tbody></table><br><br><br><table align="center"><tbody><tr><td><a href="javascript:if(confirm('http://www.ifmo.ru/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.ifmo.ru/'" tppabs="http://www.ifmo.ru/" title="Institute of fine mechanics and optics"><img border="0" src="ifmo.gif" tppabs="http://ips.ifmo.ru/img/ifmo.gif" height="29" width="64"></a></td></tr></tbody></table></td><td height="100%" valign="top"><table class="body"><tr><td><p class="link"><a href="index.htm" tppabs="http://ips.ifmo.ru/courses/webprog/" class="up">Клиентское Web-программирование</a>&nbsp;&raquo;&nbsp;<a href="index-2.htm" tppabs="http://ips.ifmo.ru/courses/webprog/part1/" class="up">Часть I</a>&nbsp;&raquo;&nbsp;Урок 2</p><p class="header">Сценарии JavaScript в документах HTML</p><a name=""></a><h2>Языки сценариев</h2><p> <em>Язык сценариев</em> - это язык программирования, используемый для выполнения функций настройки и автоматизации работы какой-либо существующей системы (например, программы просмотра Интернета, Интернет-сервера, операционной системы). Обычно в подобных системах их функциональность уже доступна через интерфейс пользователя. Языки сценариев раскрывают ее для программного управления. При этом немаловажно то, что сама система обеспечивает специальную среду, обычно состоящую из объектов и подпрограмм, которая дополняет возможности языка сценариев. </p><p> В операционной системе Windows имеется средство Windows Scripting Host (WSH), предназначенное для программной настройки системы, которое создает специальную среду со специальными объектами, позволяющими программно настраивать операционную систему, создавая файлы сценариев. В этой среде методы автоматически создаваемого объекта <tt>WScript</tt> позволяют организовать диалог с пользователем, а также создавать объекты из иерархической модели объектов этой среды (например, объект  <tt>Shell</tt> соответствует оболочке операционной системы, в семействе <tt>Environment</tt> которого хранятся значения всех переменных среды). В качестве языка сценария в WSH можно использовать либо JScript (реализация компанией Microsoft языка JavaScript) или поддерживаемый и разрабатываемый ею же собственный сценарный язык VBScript. Сценарий пишется на любом из указанных языков и сохраняется соответственно в файле с расширением <tt>.js</tt> или <tt>.vbs</tt>. Запуск сценария WSH осуществляется двойным щелчком на файле в проводнике Windows. </p><a name="example1"></a><table class="example"><caption>Пример #1. Сценарий Windows Scripting Host</caption><tr><td colspan="2"><p> Создадим в любом текстовом редакторе представленный ниже сценарий WSH на языке JScript и сохраним его в файле с расширением <tt>.js</tt>. После чего запустим его на выполнение двойным щелчком в проводнике Windows. Со всеми действиями этого сценария можно ознакомиться, прочитав внедренные в текст сценария комментарии. </p><dir><pre>

// Отображение диалогового окна с приветствием
WScript.Echo("Привет!");

text = "";

// Создание объекта Shell
shell = WScript.CreateObject("WScript.Shell")

// Присоединение к семейству WScript.Shell.Environment
// итератора для организации перебора элементов семейства
e = new Enumerator(shell.Environment);

// Перебор элементов семейства Environment
// и сохранение их значений в переменной text
for ( ; !e.atEnd(); e.moveNext()){
  text += e.item() + "\n";
}

// Отображение полученных значений в диалоговом окне
WScript.Echo(text)

         </pre></dir></td></tr></table><p> Встроенный в документ HTML сценарий JavaScript имеет доступ к объектной модели обозревателя, в котором этот документ отображается (при условии, конечно, поддержки обозревателем языка сценариев JavaScript и раскрытия своей модели объектов), а также к объектной модели (DOM) самого документа (опять-таки при ее реализации в обозревателе). </p><a name="example2"></a><table class="example"><caption>Пример #2. Сценарий JavaScript в обозревателе Internet Explorer</caption><tr><td colspan="2"><p> Создадим приведенный ниже документ HTML и отобразим его в обозревателе Internet Explorer. Каждый щелчок на кнопке <strong>Новое окно</strong> документа будет приводить к отображению еще одного окна обозревателя размером 300x50 пикселей, но без строки меню, полос прокрутки, строки состояния, панели инструментов и адресной строки. </p><dir><pre>
&lt;SCRIPT&gt;
function f(){
  newWind = window.open("", "", "width=300,height=50")
}
&lt;/SCRIPT&gt;
&lt;BODY&gt;
  &lt;FORM&gt;
     &lt;INPUT TYPE="button" VALUE="Новое окно" onclick='f()'&gt;
  &lt;/FORM&gt;
&lt;/BODY&gt;
        </pre></dir></td></tr></table><a name=""></a><h2>Язык JavaScript</h2><p> Первый язык сценариев, интерпретируемый в среде программы просмотра Интернета (для краткости будет подобную программу иногда называть браузер - от английского browser, используемого для обозначения подобных программ), был разработан в компании Netscape Communications. Встроенный в документ HTML сценарий на этом языке выполнялся в среде браузера Netscape Navigator 2.0, разработанного этой же компанией. Первоначально он назывался LiveScript, отражая его важнейшую функциональность, - встроенный в документ HTML сценарий позволял пользователю в интерактивном режиме "общаться" с отображаемой в браузере страницей. Впоследствии для привлечения внимания к своему детищу компания переименовала его в JavaScript, так как в то время язык Java приобрел такую популярность, что в Сети только о нем и говорили. Сразу же подчеркнем, что с языком Java этот язык не имеет ничего общего, разве лишь синтаксис и семантика операторов принятия решения и цикла. Эти языки разработаны для решения разных задач. Чтобы подчеркнуть этот факт следует сказать, что впоследствии компания Netscape разработала и внедрила в свой язык специальное средство для взаимодействия апплетов Java, встраиваемых в страницу HTML небольших программок, написанных на языке Java и интерпретируемых под управлением виртуальной машины Java, и сценария на языке JavaScript. В процессе своего существования язык JavaScript компании Netscape Communications постоянно изменялся, что отражалось в выпуске очередных версий, приуроченных к выпуску очередной версии браузера этой компании: </p><p> <em>Поддержка JavaScript в браузерах Netscape</em> </p><table cellspacing="0" cellpadding="0" border="1" width="50%"><tr align="center"><th>Версия браузера</th><th>Версия языка</th></tr><tr align="left"><td>Netscape 2.0</td><td>1.0</td></tr><tr align="left"><td>Netscape 3.0</td><td>1.1</td></tr><tr align="left"><td>Netscape 4.0</td><td>1.2</td></tr><tr align="left"><td>Netscape 4.5</td><td>1.3</td></tr><tr align="left"><td>Netscape 4.7</td><td>1.4</td></tr><tr align="left"><td>Netscape 6.0</td><td>1.5</td></tr></table><br><p> Не желая отставать от своего тогдашнего конкурента компания Microsoft выпустила собственный вариант языка JavaScript под названием JScript. Он также прошел ряд версий, соответствие которых браузеру этой компании представлено в следующей таблице: </p><p> <em>Поддержка JavaScript в браузерах Internet Explorer</em> </p><table cellspacing="0" cellpadding="0" border="1" width="50%"><tr align="center"><th>Версия браузера</th><th>Версия языка</th></tr><tr align="left"><td>Internet Explorer 3.0</td><td>1.0</td></tr><tr align="left"><td>Internet Explorer 4.0</td><td>3.0</td></tr><tr align="left"><td>Internet Explorer 5.0</td><td>5.0</td></tr><tr align="left"><td>Internet Explorer 5.5</td><td>5.5</td></tr><tr align="left"><td>Internet Explorer 6.0</td><td>5.6</td></tr></table><br><p> Следует отметить, что свой язык JScript компания Microsoft использовала не только в браузере, но и в других своих продуктах. </p><p> Разработка языков происходила без какого-либо взаимодействия двух компаний в режиме соревнований, что привело к известной "войне браузеров". Однако впоследствии здравомыслие восторжествовало и в 1996 году компании договорились о разработке единого стандарта под эгидой Европейской ассоциации производителей компьютеров (ECMA). И в июле 1997 года появился новый язык, получивший название ECMAScript. Сегодняшние последние версии языков JavaScript компаний Netscape Communications и Microsoft полностью соответствуют последнему стандарту языка ECMAScript, известному под названием ECMA-262, редакция 3 от 1999 г. </p><p> Задачи, решаемые с помощью встроенных в документ HTML сценариев JavaScript: </p><ul type="disk"><li><p>динамическое создание содержимого документа HTML во время его загрузки в браузер;</p></li><li><p>оперативная проверка достоверности заполняемых пользователем полей форм HTML до передачи их на сервер;</p></li><li><p>создание динамических страниц HTML совместно с каскадными таблицами стилей и объектной моделью документа;</p></li><li><p>взаимодействие с пользователем при решении "локальных" задач, реализуемых приложением JavaScript, встроенном в страницу HTML.</p></li></ul><a name=""></a><h3>Основные положения синтаксиса</h3><p> Сценарий JavaScript, являясь, по-существу, обычной программой, представляет собой последовательность операторов этого языка. </p><p> Каждый оператор с необязательным в конце разделителем (символ ;) обычно располагается в отдельной строке кода программы: </p><dir><pre>
var m=5
alert('Подсказка'+m)
m = "five";		// но можно и так
      </pre></dir><p> Разделитель обязателен только в случае задания нескольких операторов на одной строке: </p><dir><pre>
var m=5; alert('Подсказка',m)
      </pre></dir><p> Любой оператор для удобства чтения может быть продолжен на следующую строку без использования какого-либо символа продолжения: </p><dir><pre>
alert("Подсказка");
alert(
      "Подсказка"
      );
      </pre></dir><p> Нельзя продолжать на другую строку строковый литерал - он должен располагаться полностью на одной строке текста программы или разбит на два строковых литерала, соединенных операцией конкатенации +: </p><dir><pre>
alert("Подсказка") // Правильно
alert("Под         // Не правильно
       сказка")
alert("Под" +      // Правильно
      "сказка")
      </pre></dir><p> Пробельные символы в тексте программы являются незначащими, если только они не используются в строковых литералах. </p><p> Комментарии в программе JavaScript двух видов - однострочные и многострочные: </p><dir><pre>
// комментарий, расположенный на одной строке.
/*
   комментарий, расположенный
   на нескольких строках.
*/
      </pre></dir><p>Язык JavaScript <strong>чувствителен</strong> к регистру.</p><a name=""></a><h3>Размещение операторов языка на странице</h3><p>Способы встраивания сценария JavaScript в страницу HTML:</p><ul type="disk"><li><p>заданием операторов языка JavaScript внутри элемента SCRIPT документа HTML;</p></li><li><p>указанием файла с кодом JavaScript в атрибуте <tt>SRC</tt> открывающего тега элемента <tt>SCRIPT</tt>;</p></li><li><p>определением обработчика событий в открывающем теге любого элемента HTML.</p></li></ul><a name=""></a><h3>Использование элемента <tt>SCRIPT</tt></h3><p> Элемент <tt>SCRIPT</tt> состоит из открывающего тега <tt>&lt;SCRIPT&gt;</tt> и закрывающего тега <tt>&lt;/SCRIPT</tt>. Между ними записывается код JavaScript. Для совместимости с обозревателями, не поддерживающими язык сценариев JavaScript, рекомендуется код JavaScript заключать в теги комментария HTML. Необязательный атрибут <tt>LANGUAGE</tt> элемента <tt>SCRIPT</tt> задает используемый в сценарии язык (по умолчанию JavaScript). </p><dir><pre>
   &lt;SCRIPT LANGUAGE="JavaScript"&gt;
   &lt;!--
операторы JavaScript
   //--&gt;
   &lt;/SCRIPT&gt;
     </pre></dir><p> Иногда перед закрывающим тегом комментария HTML ставят символы однострочного комментария JavaScript (как в приведенном примере). Это исторический казус, относящийся к версии 3.0 MS Internet Explorer, в котором этот тег рассматривался как оператор языка JavaScript и приводил к ошибке интерпретации. </p><p> Элементов <tt>SCRIPT</tt> в документе может быть несколько, и они могут располагаться в любом его месте. Но обычно его (или их) располагают в элементе <tt>HEAD</tt> и в нем (в них) определяют функции, реализующие реакцию документа HTML на действия пользователя, перехватываемые заданными в документе обработчиками событий (см. ниже). </p><p> Следует помнить, что сценарий JavaScript, как и весь документ HTML, обрабатывается постепенно, начиная с первой строки. Поэтому если в сценарии используется, например, переменная, определяемая в элементе <tt>SCRIPT</tt>, расположенном ниже, или ссылка на объект, соответствующий элементу HTML документа, расположенному после элемента <tt>SCRIPT</tt>, то значение переменной или ссылка на объект для выполняемого в данный момент оператора будут не доступны. После завершения загрузки документа в обозреватель все глобальные переменные и ссылки на объекты HTML, естественно, становятся доступными. </p><a name=""></a><h3>Задание файла с кодом JavaScript</h3><p> В атрибуте <tt>SRC</tt> открывающего тега <tt>&lt;SCRIPT</tt> можно указать файл с кодом сценария, который будет загружен на машину клиента, вставлен в документ и интерпретирован: </p><dir><pre>
&lt;SCRIPT SRC="./functionsJS/myFuncs.js" LANGUAGE="JavaScript"&gt;
&lt;/SCRIPT&gt;
       </pre></dir><p> Такой подход удобен, если на многих страницах сайта используются, например, одни и те же функции. </p><p> Подгружаемый указанным способом файл сценария не должен содержать <em>никакой</em> разметки HTML.  </p><p> Содержимое элемента <tt>SCRIPT</tt> в последних версиях обозревателя Internet Explorer (версии 5.0 и выше) не выполняется <em>никогда</em>. Тогда как в предыдущих версиях оно выполнялось в случае, если по какой-то причине файл сценария, указанный в атрибуте <tt>SRC</tt> не был загружен. </p><a name=""></a><h3>Обработчики событий</h3><p> С помощью обработчиков событий, представляющих собой введенные в стандарт HTML дополнительные атрибуты для всех элементов HTML, реализуется реакция отображаемого в обозревателе Интернета документа на действия пользователя или системы. По-существу с их помощью документ становится "живым", реализуя событийно-управляемое приложение. </p><p> Имя обработчика начинается с приставки <tt>on</tt>, за которым следует имя самого события (о возможных событиях и их названиях см. в уроке 11): </p><p> <tt>onclick</tt> обработчик события <tt>click</tt> (щелчок мышью) </p><p> <tt>onmouseover</tt> обработчик события <tt>mouseover</tt> (наведение указателя мыши на элемент HTML) </p><p> Значением атрибута, соответствующего обработчику события, является код JavaScript. Обычно в нем задается вызов функции, реализующей "реакцию" страницы на действия пользователя, но может быть задана и целая последовательность операторов: </p><dir><pre>
&lt;p onmouseover="color(this)"
      onmouseout="color(this)"
      onclick="click++; myFunc();"&gt;. . . &lt;/p&gt;
       </pre></dir><p> <em>Функция</em> или <em>процедура</em> - это именованная последовательность операторов, которая выполняет определенную задачу и может возвращать некоторое значение, определяемое операцией <tt>return</tt> (если такой операции в теле функции нет, то ее возвращаемым значением будет специальное значение <tt>undefined</tt>): </p><dir><pre>
function имя_функции([параметры]) {
    [операторы JavaScript]
    [return значение]
}
       </pre></dir><p> Определение необходимых функций следует осуществлять в элементах <tt>SCRIPT</tt>, расположенных в элементе HEAD документа, так как они становятся доступными уже в начале обработки документа (содержимое элемента <tt>HEAD</tt> обрабатывается первым). </p><a name="example3"></a><table class="example"><caption>Пример #3. Сценарий, вычисляющий время обработки документа</caption><tr><td colspan="2"><p> В этом примере представлен документ HTML со всеми возможными способами внедрения кода сценария JavaScript, реализующий вычисление времени обработки браузером документа HTML и отображения этой информации в диалоговом окне. </p><p> Для вычисления общего времени обработки документа в сценарии, расположенном в элементе <tt>HEAD</tt>, задается переменная <tt>tBegin</tt>, в которой хранится время начала обработки документа (не считая времени, ушедшего на обработку тега <tt>&lt;HEAD&gt;</tt> и самого тега <tt>&lt;SCRIPT&gt;</tt>). </p><p> Второй элемент <tt>SCRIPT</tt> подключает файл <tt>3.js</tt>, в котором находится определение функции <tt>time()</tt>, возвращающей текущую дату. Эта функция вызывается в сценарии третьего элемента <tt>SCRIPT</tt>, расположенного в теле документа HTML (элемент <tt>BODY</tt>). В нем для отображения на странице полученной функцией <tt>time()</tt> даты используется метод <tt>write()</tt> объекта <tt>document</tt> обозревателя. Этот объект представляет всю загруженную в обозреватель страницу, и в момент ее формирования указанным методом можно "писать" на страницу все, что требуется. Однако после завершения обработки документа (при этом генерируется событие <tt>load</tt> объекта <tt>document</tt>) запись этим методом в документ приведет к тому, что в нем будет содержаться только то, что записано этим методом. </p><p> Для определения времени завершения обработки документа обозревателем используется упоминавшееся событие <tt>load</tt> и в обработчике события <tt>onload</tt> элемента <tt>BODY</tt> создается переменная <tt>tEnd</tt>, в которой и хранится время завершения обработки документа. </p><p> Для получения общего времени обработки документа по щелчку на кнопке выполняется код, определенный в ее обработчике события <tt>onclick</tt>, который вычисляет разность между временем, хранящемся в переменных <tt>tBegin</tt> и <tt>tEnd</tt> и отображает результат функцией <tt>alert()</tt>. </p><dir><pre>
&lt;HEAD&gt;
&lt;SCRIPT LANGUAGE="JavaScript"&gt;
&lt;!--
// Объявление переменной tBegin и инициализация ее
// объектом Date, содержащим текущие дату и время
var tBegin = new Date();

//--&gt;
&lt;/SCRIPT&gt;

&lt;SCRIPT SRC=3.js LANGUAGE="JavaScript"&gt;&lt;/SCRIPT&gt;
&lt;/HEAD&gt;

&lt;BODY onload="tEnd = new Date();"&gt;

&lt;P&gt;Начинается отображение страницы, в которую внедрен
         сценарий JavaScript.&lt;/P&gt;

&lt;p&gt;Следующая строка сгенерирована внедренным сценарием:&lt;/p&gt;

&lt;hr&gt;
&lt;SCRIPT&gt;
&lt;!--
document.write("&lt;p&gt;Сегодня &lt;b&gt;", time(),
               "&lt;/b&gt;&lt;/p&gt;");
//--&gt;
&lt;/SCRIPT&gt;
&lt;hr&gt;

&lt;input type=button
    onclick="delta = tEnd.getTime()-tBegin.getTime();
             s = 'Время обработки документа:\n'+delta+
             ' миллисекунд';
             alert(s)"
    value="Время обработки документа"&gt;

&lt;/BODY&gt;
         </pre></dir></td></tr>
        Файл 3.js располагается в том же каталоге, что и файл документа 
        HTML, и содержит следующий код JavaScript, определяющий функцию получения 
        текущей даты в форме число.месяц.год.
      
    // Определяем функцию, возвращающую текущую дату
    function time() {   
       d = new Date();
       return d.getDate()+"."+d.getMonth()+"."+d.getYear();
    }
      </table><br><a name="exercise1"></a><table class="exercise"><caption>Упражнение #1. </caption><tr class="exercise"><td><p> Напишите сценарий, который при загрузке документа в браузер формирует его содержимое, представляющее отображенным в виде элемента <tt>H1</tt> предложение "Привет, читатель!" и в виде абзаца строку "Сегодня, <tt>дата</tt>, ты начинаешь изучать динамический HTML.". Вместо дата сценарий должен подставлять текущую дату в формате <tt>мм.дд.гггг</tt>. </p></td></tr></table><br><a name="exercise2"></a><table class="exercise"><caption>Упражнение #2. </caption><tr class="exercise"><td><p> Сценарий, формирующий страницу HTML упражнения 1, сохранить в отдельном файле и подключить его к документу HTML через атрибут <tt>SRC</tt> открывающего тега элемента <tt>SCRIPT</tt>. Подключение выполнить, когда файл сценария располагается в том же каталоге, что и документ HTML, а также в подкаталоге каталога документа HTML и в подкаталоге каталога, содержащего каталог с документом HTML. </p></td></tr></table><br><a name="exercise3"></a><table class="exercise"><caption>Упражнение #3. </caption><tr class="exercise"><td><p> Напишите сценарий, в котором создается переменная currentDate со значением текущей даты и сразу же после обработки страницы браузером ее содержимое отображается с помощью функции <tt>alert()</tt>.  </p></td></tr></table><br><a name="exercise4"></a><table class="exercise"><caption>Упражнение #4. </caption><tr class="exercise"><td><p> Создайте страницу с кнопкой и напишите сценарий, реализующий отображение функцией <tt>alert()</tt> при щелчке на кнопке количество миллисекунд, прошедших от начала загрузки документа в браузер и до момента нажатия кнопки пользователем (каждое нажатие должно отображать увеличивающийся интервал). </p></td></tr></table><br><a name="exercise5"></a><table class="exercise"><caption>Упражнение #5. </caption><tr class="exercise"><td><p> Повторите упражнение 3, но только отсчет интервала времени следует вести от момента завершения обработки страницы браузером. </p></td></tr></table><br><table cellspacing="0" align="center" width="90%" border="0"><tr><td align="left"><a href="index.html" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l1/index.html">&lt;&lt;&lt; Предыдущий урок</a></td><td align="right"><a href="index-4.html" tppabs="http://ips.ifmo.ru/courses/webprog/part1/l3/index.html">Следующий урок &gt;&gt;&gt;</a></td></tr></table><br><br><br></td></tr></table><br></td><td background="dot.gif" tppabs="http://ips.ifmo.ru/img/dot.gif" width="1"><img width="1" src="spacer.gif" tppabs="http://ips.ifmo.ru/img/spacer.gif" height="157"></td></tr><tr><td class="lmenu" width="194" height="9"><font style="font-size:9px;font-family:arial;">Copyright &copy; 2003 IPS</font></td><td colspan="2" align="right"><img src="foot.gif" tppabs="http://ips.ifmo.ru/img/foot.gif"></td></tr></table></td></tr></table></body></html>